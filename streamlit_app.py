import streamlit as st

# --- ‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡∏ó‡∏µ‡πà 1: ‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å ---
def show_home():
    st.title("üè• HIV Care Interactive Guide")
    st.write("### ‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏ä‡πà‡∏ß‡∏¢‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡πÉ‡∏à‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏Å‡∏©‡∏≤ HIV")
    st.info("‡πÇ‡∏õ‡∏£‡∏î‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏°‡∏ô‡∏π‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏ó‡∏≤‡∏á‡∏î‡πâ‡∏≤‡∏ô‡∏ã‡πâ‡∏≤‡∏¢‡∏°‡∏∑‡∏≠ (Sidebar)")
    st.image("https://images.unsplash.com/photo-1576091160399-112ba8d25d1d?auto=format&fit=crop&w=800&q=80", caption="Digital Health for Thailand")

# --- ‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡∏ó‡∏µ‡πà 2: ‡∏ú‡∏π‡πâ‡πÉ‡∏´‡∏ç‡πà (Adult) ‡∏û‡∏£‡πâ‡∏≠‡∏° Renal Dose ---
def show_adult():
    st.header("üë§ ‡∏ú‡∏π‡πâ‡πÉ‡∏´‡∏ç‡πà (Adult Regimen)")
    st.subheader("‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏™‡∏π‡∏ï‡∏£‡∏¢‡∏≤‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏±‡∏ö Dose ‡∏ï‡∏≤‡∏°‡∏Ñ‡πà‡∏≤‡πÑ‡∏ï")
    
    # Input ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
    col1, col2 = st.columns(2)
    with col1:
        egfr = st.number_input("‡∏£‡∏∞‡∏ö‡∏∏‡∏Ñ‡πà‡∏≤ eGFR (mL/min)", min_value=0, value=15) # ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Default 15 ‡πÄ‡∏û‡∏∑‡πà‡∏≠ Test
    with col2:
        cd4 = st.number_input("‡∏£‡∏∞‡∏ö‡∏∏‡∏Ñ‡πà‡∏≤ CD4 (cells/mm3)", min_value=0, value=500)
    
    contraindication = st.multiselect(
        "‡∏Ç‡πâ‡∏≠‡∏´‡πâ‡∏≤‡∏°‡πÉ‡∏ä‡πâ/‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡πÅ‡∏û‡πâ‡∏¢‡∏≤",
        ["‡πÑ‡∏°‡πà‡∏°‡∏µ", "‡πÅ‡∏û‡πâ Abacavir (HLA-B*5701 +ve)", "‡πÑ‡∏Ç‡∏°‡∏±‡∏ô‡∏™‡∏π‡∏á (Dyslipidemia)", "‡πÇ‡∏£‡∏Ñ‡∏à‡∏¥‡∏ï‡πÄ‡∏ß‡∏ä (Psychiatric)"]
    )

    # ‡∏õ‡∏∏‡πà‡∏°‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•
    if st.button("‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏• (Analyze)"):
        st.divider()
        st.write("### ü©∫ ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå (Analysis)")

        # 1. ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏™‡∏π‡∏ï‡∏£‡∏¢‡∏≤‡∏´‡∏•‡∏±‡∏Å (Regimen Selection)
        st.write("#### 1. ‡∏™‡∏π‡∏ï‡∏£‡∏¢‡∏≤‡∏ï‡πâ‡∏≤‡∏ô‡πÑ‡∏ß‡∏£‡∏±‡∏™ (Regimen)")
        if egfr >= 30:
            if "‡πÅ‡∏û‡πâ Abacavir (HLA-B*5701 +ve)" in contraindication:
                 st.success("**‚úÖ ‡∏™‡∏π‡∏ï‡∏£‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥: TDF + 3TC + DTG (TLD)**")
            else:
                 st.success("**‚úÖ ‡∏™‡∏π‡∏ï‡∏£‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ (Preferred): TDF + 3TC + DTG (TLD)**")
            st.caption("‡∏™‡∏π‡∏ï‡∏£‡πÄ‡∏°‡πá‡∏î‡∏£‡∏ß‡∏° ‡∏ß‡∏±‡∏ô‡∏•‡∏∞ 1 ‡πÄ‡∏°‡πá‡∏î (‡∏´‡∏≤‡∏Å eGFR > 30)")
        else:
            st.warning("**‚ö†Ô∏è ‡∏Ñ‡πà‡∏≤ eGFR < 30: ‡∏Ñ‡∏ß‡∏£‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á TDF**")
            st.info("**‡∏ó‡∏≤‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å (Alternative):**\n- **TAF/FTC + DTG** (‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡∏Å‡∏ß‡πà‡∏≤‡πÉ‡∏ô‡πÇ‡∏£‡∏Ñ‡πÑ‡∏ï)\n- **ABC/3TC + DTG** (‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡πÅ‡∏û‡πâ ABC)")

        # 2. ‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏ô‡∏≤‡∏î‡∏¢‡∏≤‡∏ï‡∏≤‡∏°‡πÑ‡∏ï (Renal Dosage Adjustment)
        st.divider()
        st.write(f"#### 2. ‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏ô‡∏≤‡∏î‡∏¢‡∏≤‡∏ï‡∏≤‡∏° eGFR ({egfr} mL/min)")
        
        if egfr >= 50:
            st.success("‚ú® **‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏ô‡∏≤‡∏î‡∏¢‡∏≤ (No Adjustment Needed)**\n- ‡πÉ‡∏ä‡πâ‡∏Ç‡∏ô‡∏≤‡∏î‡∏õ‡∏Å‡∏ï‡∏¥‡πÑ‡∏î‡πâ‡∏ó‡∏∏‡∏Å‡∏ï‡∏±‡∏ß (Standard Dose)")
        else:
            st.error(f"üö® **‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏ô‡∏≤‡∏î‡∏¢‡∏≤ (Adjustment Required)** ‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å eGFR < 50")
            
            # ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ Dose
            st.markdown("##### ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏£‡∏≤‡∏¢‡∏ï‡∏±‡∏ß‡∏¢‡∏≤ (Individual Drug Dosing):")
            
            # Logic ‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏¢‡∏≤ 3TC (Lamivudine)
            if 30 <= egfr < 50:
                st.write("- **3TC (Lamivudine):** ‡∏•‡∏î‡πÄ‡∏´‡∏•‡∏∑‡∏≠ **150 mg ‡∏ß‡∏±‡∏ô‡∏•‡∏∞ 1 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á**")
            elif egfr < 30:
                st.write(f"- **3TC (Lamivudine):** ‡∏•‡∏î‡πÄ‡∏´‡∏•‡∏∑‡∏≠ **150 mg ‡∏ß‡∏±‡∏ô‡πÅ‡∏£‡∏Å** ‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏ô‡∏±‡πâ‡∏ô‡∏•‡∏î‡πÄ‡∏´‡∏•‡∏∑‡∏≠ **50-100 mg ‡∏ß‡∏±‡∏ô‡∏•‡∏∞ 1 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á** (‡∏ï‡∏≤‡∏° Guideline)")
                st.caption("*‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏: ‡∏¢‡∏≤‡∏ô‡πâ‡∏≥‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏° (Oral Solution) ‡∏≠‡∏≤‡∏à‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏ô‡∏≤‡∏î‡πÑ‡∏î‡πâ‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥‡∏Å‡∏ß‡πà‡∏≤‡πÉ‡∏ô eGFR ‡∏ï‡πà‡∏≥‡∏°‡∏≤‡∏Å*")

            # Logic ‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏¢‡∏≤ TDF
            if egfr < 50:
                 st.write("- **TDF (Tenofovir DF):** ‚ùå **‡πÑ‡∏°‡πà‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ** (‡∏´‡∏£‡∏∑‡∏≠‡∏õ‡∏£‡∏±‡∏ö‡πÄ‡∏õ‡πá‡∏ô 300 mg ‡∏ó‡∏∏‡∏Å 48 ‡∏ä‡∏°. ‡∏ã‡∏∂‡πà‡∏á‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏¢‡∏≤‡∏Å)")
                 st.write("  üëâ *‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô TAF ‡∏´‡∏£‡∏∑‡∏≠ ABC*")

            # Logic ‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏¢‡∏≤ FTC (Emtricitabine) - ‡πÄ‡∏ú‡∏∑‡πà‡∏≠‡∏Å‡∏£‡∏ì‡∏µ‡πÉ‡∏ä‡πâ‡∏™‡∏π‡∏ï‡∏£ TAF/FTC
            if 30 <= egfr < 49:
                st.write("- **FTC (Emtricitabine):** **200 mg ‡∏ó‡∏∏‡∏Å 48 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á**")
            elif 15 <= egfr < 30:
                 st.write("- **FTC (Emtricitabine):** **200 mg ‡∏ó‡∏∏‡∏Å 72 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á**")
            elif egfr < 15:
                 st.write("- **FTC (Emtricitabine):** **200 mg ‡∏ó‡∏∏‡∏Å 96 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á**")

# --- ‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡∏ó‡∏µ‡πà 3: ‡πÄ‡∏î‡πá‡∏Å (Pediatric) ---
def show_pediatric():
    st.header("üë∂ ‡πÄ‡∏î‡πá‡∏Å (Pediatric)")
    st.warning("üöß ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏û‡∏±‡∏í‡∏ô‡∏≤ (Under Construction)")

# --- ‡∏™‡πà‡∏ß‡∏ô‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏´‡∏•‡∏±‡∏Å (Main Control) ---
def main():
    st.sidebar.title("‡πÄ‡∏°‡∏ô‡∏π‡∏´‡∏•‡∏±‡∏Å")
    menu = st.sidebar.radio(
        "‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡∏´‡∏ô‡πâ‡∏≤:",
        ["üè† ‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å", "üë§ ‡∏ú‡∏π‡πâ‡πÉ‡∏´‡∏ç‡πà (Adult)", "üë∂ ‡πÄ‡∏î‡πá‡∏Å (Pediatrics)", "üíä ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô (PrEP/PEP)"]
    )

    if menu == "üè† ‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å":
        show_home()
    elif menu == "üë§ ‡∏ú‡∏π‡πâ‡πÉ‡∏´‡∏ç‡πà (Adult)":
        show_adult()
    elif menu == "üë∂ ‡πÄ‡∏î‡πá‡∏Å (Pediatrics)":
        show_pediatric()
    elif menu == "üíä ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô (PrEP/PEP)":
        st.header("üíä PrEP / PEP")
        st.info("‡∏£‡∏≠‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...")

if __name__ == "__main__":
    main()
